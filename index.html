<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQUIGLINK MONITOR</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { 
            --bg: #050505; 
            --card: #111111; 
            --border: #222222; 
            --text-main: #ffffff; 
            --text-dim: #a1a1aa;
            --accent: #ffffff;
        }

        body { 
            background: var(--bg); 
            color: var(--text-main); 
            font-family: 'Inter', sans-serif; 
            -webkit-font-smoothing: antialiased; 
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        /* Dashboard Cards */
        .stat-card { 
            background: linear-gradient(145deg, #111111 0%, #080808 100%);
            border: 1px solid var(--border); 
            padding: 1.5rem; 
            border-radius: 4px; 
            transition: border-color 0.3s ease;
        }
        .stat-card:hover { border-color: #444; }

        /* Row Visibility */
        .item-row { 
            border-bottom: 1px solid #111; 
            padding: 1.5rem 0.5rem;
            transition: all 0.2s ease;
        }
        .item-row:hover { 
            background: #0c0c0c;
            padding-left: 1rem;
        }

        /* Improved Badge Visibility */
        .rig-badge {
            font-size: 10px;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 3px;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        /* Navigation & Filters */
        .tab-btn {
            padding: 0.75rem 1.5rem;
            font-size: 13px;
            font-weight: 600;
            color: #52525b;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        .tab-btn.active { color: white; border-bottom-color: white; }

        .filter-btn { 
            background: #111;
            border: 1px solid var(--border);
            padding: 0.5rem 1rem;
            font-size: 12px;
            color: #a1a1aa;
            border-radius: 4px;
        }
        .filter-btn.active { 
            background: #222;
            border-color: #52525b;
            color: white;
        }

        /* Search Input Fix */
        #search {
            background: #0a0a0a;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem 1.5rem;
            font-size: 1.1rem;
            transition: all 0.2s;
        }
        #search:focus {
            border-color: #52525b;
            background: #0d0d0d;
            outline: none;
        }

        /* Chart Visuals */
        .chart-bar-container { background: #1a1a1a; height: 6px; border-radius: 10px; margin: 12px 0; }
        .chart-bar-fill { border-radius: 10px; }

        .new-label {
            background: #ffffff;
            color: #000000;
            font-weight: 900;
            padding: 1px 6px;
            border-radius: 2px;
            font-size: 10px;
        }
    </style>
</head>
<body class="max-w-6xl lg:max-w-7xl mx-auto px-6 py-12">

    <header class="mb-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
            <div class="stat-card">
                <span class="block text-[11px] uppercase tracking-[0.2em] text-zinc-500 font-bold mb-2">Sync Activity (12H)</span>
                <span id="stat-total" class="text-4xl font-bold mono text-white">0</span>
            </div>
            <div class="stat-card">
                <span class="block text-[11px] uppercase tracking-[0.2em] text-zinc-500 font-bold mb-2">Global Database</span>
                <span id="stat-db-total" class="text-4xl font-bold mono text-white">0</span>
            </div>
            <div class="stat-card">
                <span class="block text-[11px] uppercase tracking-[0.2em] text-zinc-500 font-bold mb-2">Verified Sources</span>
                <span id="stat-sources" class="text-4xl font-bold mono text-white">0</span>
            </div>
        </div>

        <div class="flex justify-between items-center border-b border-zinc-800 mb-8">
            <div class="flex gap-2">
                <button onclick="switchTab('feed')" id="tab-feed" class="tab-btn active mono uppercase tracking-widest">Live Feed</button>
                <button onclick="switchTab('stats')" id="tab-stats" class="tab-btn mono uppercase tracking-widest">Statistics</button>
            </div>
            <div class="flex items-center gap-3 px-4 py-2 bg-zinc-900/50 rounded-full border border-zinc-800">
                <span class="text-[10px] mono text-zinc-400 uppercase font-bold">System Online</span>
                <span class="relative flex h-2 w-2">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-500 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                </span>
            </div>
        </div>

        <div id="rig-filters-container" class="space-y-6 mb-10">
            <div class="flex flex-wrap gap-3">
                <button onclick="setRigFilter('ALL')" class="filter-btn active mono" id="filter-ALL">All Results <span class="ml-2 opacity-50 text-[10px]" id="count-ALL">0</span></button>
                <button onclick="setRigFilter('711')" class="filter-btn mono" id="filter-711">711 Standard <span class="ml-2 opacity-50 text-[10px]" id="count-711">0</span></button>
                <button onclick="setRigFilter('5128')" class="filter-btn mono" id="filter-5128">Type 5128 <span class="ml-2 opacity-50 text-[10px]" id="count-5128">0</span></button>
            </div>

            <input type="text" id="search" placeholder="FILTER BY DEVICE OR REVIEWER..." 
                class="w-full mono uppercase tracking-widest text-white placeholder-zinc-700">
        </div>
    </header>

    <main id="feed" class="space-y-1"></main>
    <main id="stats" class="hidden grid grid-cols-1 md:grid-cols-2 gap-8 py-4"></main>
    
    <button id="load-all-btn" class="mt-12 w-full py-4 border border-zinc-800 text-zinc-500 mono uppercase tracking-widest hover:bg-white hover:text-black transition-all rounded">
        Load Older Entries
    </button>

<script>
    /* CORE LOGIC MODIFICATIONS 
       I have updated the THEME_COLORS to use high-contrast solid backgrounds 
       instead of borders for the rig labels.
    */
    const THEME_COLORS = {
        "IEM (5128)": { text: "text-white", bg: "bg-emerald-600" },
        "Over-Ear (5128)": { text: "text-white", bg: "bg-teal-600" },
        "IEM (711)": { text: "text-white", bg: "bg-zinc-700" },
        "Over-Ear (711)": { text: "text-white", bg: "bg-blue-600" },
        "TWS & Earbuds": { text: "text-white", bg: "bg-indigo-600" },
        "Misc/Unknown": { text: "text-white", bg: "bg-amber-800" }
    };

    // ... [Rest of your logic: fetchData, applyFilters, etc] ...
    // Note: Ensure getEntryMetadata() includes the dl.squig.link override from previous step.

    function renderItems(data, containerId, append = false) {
        const container = document.getElementById(containerId);
        const html = data.map(entry => {
            const date = toLocalTime(entry.date);
            const isNew = date && (new Date() - date) < NEW_BADGE_MS;
            const rigType = getEntryMetadata(entry);
            const theme = THEME_COLORS[rigType] || THEME_COLORS["Misc/Unknown"];
            
            return `
                <div class="item-row flex justify-between items-center group">
                    <div class="min-w-0">
                        <div class="flex items-center gap-3 mb-2">
                            ${isNew ? '<span class="new-label">NEW</span>' : ''}
                            <span class="text-xs font-bold text-zinc-500 uppercase tracking-widest">${entry.reviewer}</span>
                            <span class="rig-badge ${theme.bg} ${theme.text}">${rigType}</span>
                            <span class="text-xs text-zinc-600 mono">${getRelativeTime(date)}</span>
                        </div>
                        <h2 class="text-xl lg:text-2xl font-bold text-zinc-200 group-hover:text-white transition-colors truncate">${resolveName(entry.item)}</h2>
                    </div>
                    <a href="${entry.link}" target="_blank" class="shrink-0 ml-4 p-4 rounded bg-zinc-900 border border-zinc-800 text-zinc-500 hover:text-white hover:border-zinc-500 transition-all">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M14 5l7 7m0 0l-7 7m7-7H3" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </a>
                </div>`;
        }).join('');

        if (append) container.insertAdjacentHTML('beforeend', html);
        else container.innerHTML = html;
    }
    
    // [Maintain all other functions from your original code]
</script>
</body>
</html>
